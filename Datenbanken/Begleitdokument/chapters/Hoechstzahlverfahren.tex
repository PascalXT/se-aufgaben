\chapter{Details zur Implementierung der Sitzverteilung}
2009 wurde die Sitzverteilung nach dem Verfahren von Sainte-Laguë/Schepers ermittelt. Um dieses Verfahren umzusetzen werden drei verschiedene Algorithmen vorgeschlagen, die rechtlich gleichwertig sind. Für die Implementierung in SQL bietet sich das Höchstzahlverfahren an. In Kapitel \ref{chap:SQL-Befehle} ist das Verfahren in folgenden Teiltabellen umgesetzt:

\lstinputlisting{chapters/queries/Hoechstzahlverfahren1.sql}

\lstinputlisting{chapters/queries/Hoechstzahlverfahren2.sql}

Das im Höchstzahlverfahren vorgesehene Schrittweise erhöhen des Divisors für jede einzelne Partei wird durch die Divisoren Tabelle verwirklicht. Für jede Partei wird für jeden Divisor eine Punktzahl ermittelt. Anschließend werden für die höchsten Punktzahlen Plätze im Bundestag vergeben.

Eine der Schwierigkeiten bei der Umsetzung des Höchstzahlverfahren in SQL ist die Behandlung von Stimmgleichständen. Wenn zwei oder mehr Parteien exakt gleich viele Stimmen haben, muss der Wahlleiter zufällig den Gewinner bestimmen. Die SQL Abfrage hat aber nicht die Möglichkeit während der Berechnung den Wahlleiter zu kontaktieren. Stattdessen muss der Wahlleiter Zufallsentscheidungen für die Maximal mögliche Anzahl von Entscheidungsfällen bereits vor der Auswertung bereitstellen. Diese Zufallsentscheidungen sind in der Implementierung zu diesem Dokument in der Tabelle Zufallszahlen abgelegt. Die Tabelle hat die Form (Zeile, Zahl). Die Zeile entspricht der Instanz der Zufallsentscheidung. Für die 7. mögliche Zufallsentscheidung wird also die Zeile 7 der Zufallstabelle verwendet. Durch automatische Generierung der Spalte Zeile wird sicher-ge-stellt, dass jede Zeilenzahl zwischen $0$ und $\left(\#Zeilen - 1\right)$ genau einmal vorkommt. Die Zahl wird dann als Entscheidungfinder verwendet: Wenn es n mögliche Alternativen gibt und die Zufallszahl z die Entscheidung liefern soll, so wird die Alternative $z mod n$ gewählt.

Dieses Zufallsverfahren kommt für die Ermittlung der Direktmandate, für das Höchst\-zahl\-ver\-fah\-ren zur Ermittlung der Sitze pro Partei, sowie für das Höchstzahlverfahren zur Ermittlung der Sitze pro Landesliste zum Einsatz. Um Mehrfachverwendung derselben Zufallszahlen zu vermeiden, werden drei getrennte Zufallszahlentabellen verwendet.